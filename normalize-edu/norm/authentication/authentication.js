var _0x3e1d=['super_admin','sendError','postgres','name','psql','assign','body','length','findByEmail','findUser','then','createSecureUser','appendSecretFields','errorCode','insert','TEST_EMAIL','Secure\x20User\x20Created!','<p>You\x20are\x20now\x20a\x20part\x20of\x20NobleOne\x20user\x20group!</p>','emailer','user\x20already\x20exist!','user','undefined','User\x20is\x20not\x20logged\x20in!','logout','session','destroy','getSessionUser','env','DOC_STORAGE_API_URL','findOne','email','compare','password','sign','JWT_SECRET','login','findIndex','loginErrCount','is_activated','docServerLogin','Your\x20account\x20has\x20been\x20locked!\x20Please\x20contact\x20your\x20administrator\x20to\x20unlock\x20your\x20account!','unlockAccount','reqUser','Account\x20Locked!\x20This\x20is\x20unusual!','userID','updateSet','<p>Dear\x20User</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>Your\x20account\x20has\x20been\x20unlocked\x20and\x20restored\x20by\x20an\x20administrator!</p>','Account\x20Restored!\x20Your\x20account\x20has\x20been\x20restored!','Account\x20Restore\x20Failed!\x20Your\x20account\x20does\x20not\x20have\x20proper\x20privileges\x20to\x20unlock\x20account!\x20Please\x20contact\x20an\x20administrator!','/user/login','POST','FILE_STORAGE_APP_PASSWORD','statusCode','token','status','Unable\x20to\x20login\x20to\x20document\x20server','changePassword','getToken','oldPassword','Incorrect\x20password!','password_reset_at','localtimestamp','email_reminder_count','locked','update','Password\x20updated!','Password\x20must\x20be\x20defined!','Trying\x20to\x20change\x20someone\x20else\x27s\x20password?','oldPassword\x20must\x20be\x20defined!','user\x20does\x20not\x20exist!','newPassword','verify','<p>You\x20have\x20recovered\x20your\x20password!\x20Please\x20Login!</p>','newPassword\x20must\x20be\x20defined!','Token\x20is\x20no\x20longer\x20valid\x20or\x20has\x20expired!','sendRecoverEmail','Password\x20Reset\x20Request!','<p>You\x20have\x20requested\x20a\x20password\x20reset!\x20Please\x20go\x20<a\x20href=\x22','/#/password-reset?token=','\x22>Here</a>\x20to\x20reset\x20your\x20password.\x20This\x20link\x20is\x20only\x20valid\x20for\x20the\x20next\x2030\x20minutes.</p>','secretFields','getAllSecretFields','find\x20by\x20email\x20error!\x20User\x20may\x20not\x20exist!','get','<p>You\x20have\x20changed\x20your\x20password!\x20Please\x20Login.</p>','lockAccount','Account\x20Locked!','<p>Dear\x20Admin</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>The\x20account\x20for\x20user\x20email:\x20','defineProperty','../email/mailer','bcrypt','jsonwebtoken','request','defaults','options','isSuperAdmin','dbType','mongo','findById','params','json','model','controller','send'];(function(_0x43af0f,_0x1733e0){var _0xf41fff=function(_0x4a6f85){while(--_0x4a6f85){_0x43af0f['push'](_0x43af0f['shift']());}};_0xf41fff(++_0x1733e0);}(_0x3e1d,0x128));var _0x1ed6=function(_0x3ea083,_0x40e30a){_0x3ea083=_0x3ea083-0x0;var _0x1f5072=_0x3e1d[_0x3ea083];return _0x1f5072;};'use strict';Object[_0x1ed6('0x0')](exports,'__esModule',{'value':!![]});const mailer_1=require(_0x1ed6('0x1'));const bcrypt=require(_0x1ed6('0x2'));const jwt=require(_0x1ed6('0x3'));const saltRounds=0xa;const request=require(_0x1ed6('0x4'))[_0x1ed6('0x5')]({'encoding':null});class Authentication{constructor(_0x4bec6b,_0x1fafb8,_0x1d2ba0){this['model']=_0x4bec6b;this[_0x1ed6('0x6')]=_0x1fafb8;this['name']=_0x1d2ba0;this[_0x1ed6('0x7')]=(_0x482b94,_0x5755fc,_0x178d74)=>{if(this[_0x1ed6('0x6')][_0x1ed6('0x8')]==_0x1ed6('0x9')){this['model'][_0x1ed6('0xa')](_0x482b94[_0x1ed6('0xb')]['id'],(_0x38d1d1,_0x25425d)=>{if(!_0x38d1d1){_0x5755fc[_0x1ed6('0xc')](this[_0x1ed6('0xd')][_0x1ed6('0xe')][_0x1ed6('0xf')](0xc8,{'is_super_admin':_0x25425d[_0x1ed6('0x10')]}));}else{_0x5755fc['json'](this[_0x1ed6('0xd')]['controller'][_0x1ed6('0x11')](0x1f4,_0x38d1d1));}});}else if(this['options'][_0x1ed6('0x8')]==_0x1ed6('0x12')){const _0x3db2cf={'get':[_0x1ed6('0x10')],'table':this[_0x1ed6('0x13')],'where':{'id':_0x482b94[_0x1ed6('0xb')]['id']}};this['model'][_0x1ed6('0xe')][_0x1ed6('0x14')]['get'](Object[_0x1ed6('0x15')](_0x482b94[_0x1ed6('0x16')],{'body':_0x3db2cf}),_0x5755fc,_0x178d74,_0x2b6d26=>{if(_0x2b6d26[_0x1ed6('0x17')]>0x0){_0x5755fc[_0x1ed6('0xc')](this[_0x1ed6('0xd')][_0x1ed6('0xe')][_0x1ed6('0xf')](0xc8,_0x2b6d26[0x0]));}else{_0x5755fc[_0x1ed6('0xc')](this[_0x1ed6('0xd')]['controller'][_0x1ed6('0x11')](0x1f4,_0x2b6d26));}});}};this[_0x1ed6('0x18')]=(_0x2a72d2,_0x58250b,_0x28e6fe)=>{this[_0x1ed6('0x19')](_0x2a72d2,_0x58250b,_0x28e6fe)[_0x1ed6('0x1a')](_0x3662e2=>{_0x58250b[_0x1ed6('0xc')](this[_0x1ed6('0xd')][_0x1ed6('0xe')][_0x1ed6('0xf')](0xc8,_0x3662e2));});};this[_0x1ed6('0x1b')]=(_0x2e5afe,_0x19acca,_0x17d535)=>{this[_0x1ed6('0x1c')](_0x2e5afe);this[_0x1ed6('0x19')](_0x2e5afe,_0x19acca,_0x17d535)[_0x1ed6('0x1a')](_0x100b5f=>{if(_0x100b5f[_0x1ed6('0x1d')]==0x1f4){this[_0x1ed6('0xd')][_0x1ed6('0xe')]['psql'][_0x1ed6('0x1e')](_0x2e5afe,_0x19acca,_0x17d535,_0x3966f5=>{if(_0x3966f5){const _0x26b3c1={'from':process['env'][_0x1ed6('0x1f')],'to':process['env']['TEST_EMAIL'],'subject':_0x1ed6('0x20'),'html':_0x1ed6('0x21')};this[_0x1ed6('0x22')][_0x1ed6('0xf')](_0x26b3c1);_0x19acca[_0x1ed6('0xc')](this['model'][_0x1ed6('0xe')][_0x1ed6('0xf')](0xc8,_0x3966f5));}});}else{_0x19acca['json'](this[_0x1ed6('0xd')][_0x1ed6('0xe')][_0x1ed6('0x11')](0x191,_0x1ed6('0x23')));}});};this['isLoggedIn']=(_0x4c338c,_0xe6ae30,_0x5519b7)=>{const _0x1e81ae=typeof _0x4c338c['session'][_0x1ed6('0x24')]!==_0x1ed6('0x25');if(_0x1e81ae){_0xe6ae30[_0x1ed6('0xc')](this[_0x1ed6('0xd')][_0x1ed6('0xe')][_0x1ed6('0xf')](0xc8,_0x1e81ae));}else{_0xe6ae30['json'](this[_0x1ed6('0xd')]['controller'][_0x1ed6('0x11')](0x1f4,_0x1ed6('0x26')));}};this[_0x1ed6('0x27')]=(_0x264957,_0x5f1a8b,_0x1d0ea3)=>{_0x264957[_0x1ed6('0x28')][_0x1ed6('0x29')](_0x401f1e=>{_0x5f1a8b['json'](this[_0x1ed6('0xd')]['controller']['send'](0xc8,'User\x20is\x20logged\x20out!'));});};this[_0x1ed6('0x2a')]=(_0x1123bd,_0x30b005,_0x59498c)=>{if(typeof _0x1123bd[_0x1ed6('0x28')][_0x1ed6('0x24')]!==_0x1ed6('0x25')){_0x30b005[_0x1ed6('0xc')](this[_0x1ed6('0xd')][_0x1ed6('0xe')][_0x1ed6('0xf')](0xc8,_0x1123bd[_0x1ed6('0x28')][_0x1ed6('0x24')]));}else{_0x30b005[_0x1ed6('0xc')](this[_0x1ed6('0xd')][_0x1ed6('0xe')][_0x1ed6('0x11')](0x1f4,'User\x20session\x20not\x20found!'));}};this['login']=(_0x13822b,_0x5dd332,_0xc1b33a)=>{const _0x524a53=process[_0x1ed6('0x2b')][_0x1ed6('0x2c')]!=null&&process[_0x1ed6('0x2b')][_0x1ed6('0x2c')]!='';if(this[_0x1ed6('0x6')][_0x1ed6('0x8')]==_0x1ed6('0x9')){this[_0x1ed6('0xd')][_0x1ed6('0x2d')]({'email':_0x13822b[_0x1ed6('0x16')][_0x1ed6('0x2e')]},(_0x146f31,_0x332dd7)=>{if(_0x146f31){_0x5dd332[_0x1ed6('0xc')](this[_0x1ed6('0xd')][_0x1ed6('0xe')][_0x1ed6('0x11')](0x1f4,_0x146f31));}else if(_0x332dd7){bcrypt[_0x1ed6('0x2f')](_0x13822b[_0x1ed6('0x16')][_0x1ed6('0x30')],_0x332dd7[_0x1ed6('0x30')],(_0x146f31,_0x4e6077)=>{if(!_0x4e6077){_0x5dd332['json'](this[_0x1ed6('0xd')]['controller'][_0x1ed6('0x11')](0x1f4,'Incorrect\x20password!'));}else{_0x5dd332[_0x1ed6('0xc')]({'token':jwt[_0x1ed6('0x31')](_0x332dd7,process['env'][_0x1ed6('0x32')]),'user':_0x332dd7});}});}else{_0x5dd332['json'](this[_0x1ed6('0xd')]['controller'][_0x1ed6('0x11')](0x1f4,_0x146f31));}});}else if(this[_0x1ed6('0x6')][_0x1ed6('0x8')]==_0x1ed6('0x12')){_0x13822b[_0x1ed6('0x28')]['login']==null?_0x13822b['session'][_0x1ed6('0x33')]=[]:null;const _0x2c6f0f={};_0x2c6f0f[_0x13822b[_0x1ed6('0x16')]['email']]={};let _0x51581b=_0x13822b[_0x1ed6('0x28')][_0x1ed6('0x33')][_0x1ed6('0x34')]((_0x1b6a84,_0x22260e,_0xfbe084)=>{return _0x1b6a84[_0x13822b[_0x1ed6('0x16')]['email']]!=null;});if(_0x51581b==-0x1){_0x13822b['session'][_0x1ed6('0x33')]['push'](_0x2c6f0f);_0x51581b=_0x13822b[_0x1ed6('0x28')][_0x1ed6('0x33')][_0x1ed6('0x17')]-0x1;}_0x13822b[_0x1ed6('0x28')][_0x1ed6('0x33')][_0x51581b]['loginErrCount']==null?_0x13822b[_0x1ed6('0x28')][_0x1ed6('0x33')][_0x51581b][_0x1ed6('0x35')]=0x0:null;this[_0x1ed6('0x19')](_0x13822b,_0x5dd332,_0xc1b33a)[_0x1ed6('0x1a')](_0x4d80b3=>{if(_0x4d80b3['errorCode']==0x1f4){_0x5dd332[_0x1ed6('0xc')](this[_0x1ed6('0xd')][_0x1ed6('0xe')][_0x1ed6('0x11')](0x1f4,_0x4d80b3));}else if(_0x4d80b3){if(!_0x4d80b3['locked']){bcrypt[_0x1ed6('0x2f')](_0x13822b[_0x1ed6('0x16')]['password'],_0x4d80b3['password'],(_0x2bc9be,_0x4af943)=>{if(!_0x4af943){_0x13822b[_0x1ed6('0x28')][_0x1ed6('0x33')][_0x51581b][_0x1ed6('0x35')]++;if(_0x13822b[_0x1ed6('0x28')]['login'][_0x51581b]['loginErrCount']>=0x5){this['lockAccount'](_0x4d80b3,_0x51581b,_0x13822b,_0x5dd332,_0xc1b33a);}else{_0x5dd332[_0x1ed6('0xc')](this['model'][_0x1ed6('0xe')][_0x1ed6('0x11')](0x1f4,{'message':'Incorrect\x20password!','attempt':_0x13822b[_0x1ed6('0x28')][_0x1ed6('0x33')][_0x51581b][_0x1ed6('0x35')]}));}}else{_0x13822b[_0x1ed6('0x28')][_0x1ed6('0x33')][_0x51581b][_0x1ed6('0x35')]=0x0;this['appendSecretFields'](_0x13822b);if(!_0x4d80b3[_0x1ed6('0x36')]){this['activateAccount'](_0x4d80b3,_0x13822b,_0x5dd332,_0xc1b33a,_0x6737c7=>{_0x13822b['session'][_0x1ed6('0x24')]=_0x6737c7[0x0];if(_0x524a53){this[_0x1ed6('0x37')](_0x13822b,_0x5dd332,_0xc1b33a,_0x6737c7[0x0]);}else{_0x5dd332[_0x1ed6('0xc')]({'token':jwt[_0x1ed6('0x31')](_0x6737c7[0x0],process[_0x1ed6('0x2b')][_0x1ed6('0x32')]),'user':_0x6737c7[0x0],'session':_0x13822b[_0x1ed6('0x28')]});}});}else{_0x13822b[_0x1ed6('0x28')][_0x1ed6('0x24')]=_0x4d80b3;if(_0x524a53){this[_0x1ed6('0x37')](_0x13822b,_0x5dd332,_0xc1b33a,_0x4d80b3);}else{_0x5dd332[_0x1ed6('0xc')]({'token':jwt[_0x1ed6('0x31')](_0x4d80b3,process[_0x1ed6('0x2b')][_0x1ed6('0x32')]),'user':_0x4d80b3,'session':_0x13822b['session']});}}}});}else{_0x5dd332[_0x1ed6('0xc')](this[_0x1ed6('0xd')][_0x1ed6('0xe')]['sendError'](0x1a7,_0x1ed6('0x38')));}}else{_0x5dd332['json'](this['model'][_0x1ed6('0xe')]['sendError'](0x1f4,'User\x20not\x20found!'));}});}};this[_0x1ed6('0x39')]=(_0x540655,_0x3ac8a6,_0x435257)=>{let _0x13d96f={'body':{'email':_0x540655[_0x1ed6('0x3a')][_0x1ed6('0x2e')]}};this[_0x1ed6('0x19')](_0x13d96f,_0x3ac8a6,_0x435257)[_0x1ed6('0x1a')](_0x5d419e=>{if(_0x5d419e[_0x1ed6('0x1d')]==0x1f4){_0x3ac8a6['json'](this[_0x1ed6('0xd')][_0x1ed6('0xe')][_0x1ed6('0x11')](0x1f4,_0x1ed6('0x3b')));}else if(_0x5d419e){if(_0x5d419e['super_admin']){const _0xbc29c5={'body':{'locked':![],'where':{'id':_0x540655[_0x1ed6('0x16')][_0x1ed6('0x3c')]}}};this[_0x1ed6('0xd')][_0x1ed6('0xe')][_0x1ed6('0x14')][_0x1ed6('0x3d')](_0xbc29c5,_0x3ac8a6,_0x435257,_0x2a2e34=>{if(_0x2a2e34){this[_0x1ed6('0x22')][_0x1ed6('0xf')]({'from':process[_0x1ed6('0x2b')][_0x1ed6('0x1f')],'to':process[_0x1ed6('0x2b')][_0x1ed6('0x1f')],'subject':'Account\x20Restored!','html':_0x1ed6('0x3e')});_0x3ac8a6[_0x1ed6('0xc')](this[_0x1ed6('0xd')]['controller']['send'](0xc8,_0x1ed6('0x3f')));}});}else{_0x3ac8a6[_0x1ed6('0xc')](this['model']['controller']['sendError'](0x1f4,_0x1ed6('0x40')));}}});};this['docServerLogin']=(_0x27b8c4,_0x419f69,_0x34e462,_0x36cde0)=>{return new Promise(_0x321d84=>{request({'url':process['env'][_0x1ed6('0x2c')]+_0x1ed6('0x41'),'method':_0x1ed6('0x42'),'json':!![],'headers':{'content-type':'application/json'},'body':{'email':process[_0x1ed6('0x2b')]['FILE_STORAGE_APP_EMAIL'],'password':process['env'][_0x1ed6('0x43')]}},(_0x3a54a7,_0x3ca153,_0xc7f78c)=>{if(!_0x3a54a7&&_0x3ca153[_0x1ed6('0x44')]==0xc8){_0x419f69[_0x1ed6('0xc')]({'token':jwt['sign'](_0x36cde0,process[_0x1ed6('0x2b')]['JWT_SECRET']),'docToken':_0xc7f78c[_0x1ed6('0x45')],'user':_0x36cde0});}else{_0x419f69[_0x1ed6('0x46')](0x1f4)[_0x1ed6('0xf')]({'message':_0x1ed6('0x47')});}});});};this[_0x1ed6('0x48')]=(_0x2c86cd,_0x4a378b,_0x546f15)=>{this['model'][_0x1ed6('0xe')]['getRequestUser'](this[_0x1ed6('0xd')]['controller'][_0x1ed6('0x49')](_0x2c86cd),(_0x4c6f63,_0x4aff11)=>{this[_0x1ed6('0x19')](_0x2c86cd,_0x4a378b,_0x546f15)[_0x1ed6('0x1a')](_0x3c59c9=>{_0x2c86cd[_0x1ed6('0x3a')]==null?_0x2c86cd[_0x1ed6('0x3a')]=_0x4aff11:null;if(!_0x3c59c9['errorCode']){const _0x17c0f4=_0x2c86cd['body'][_0x1ed6('0x4a')];const _0x42bf6d=_0x2c86cd[_0x1ed6('0x16')][_0x1ed6('0x30')];if(_0x17c0f4&&_0x17c0f4!=null){bcrypt['compare'](_0x2c86cd['body']['oldPassword'],_0x3c59c9[_0x1ed6('0x30')],(_0x4c6f63,_0x1e35e5)=>{if(!_0x1e35e5){_0x4a378b['json'](this[_0x1ed6('0xd')]['controller'][_0x1ed6('0x11')](0x1f4,_0x1ed6('0x4b')));}else{const _0x4788bd=_0x2c86cd[_0x1ed6('0x3a')]&&_0x2c86cd[_0x1ed6('0x3a')]!=null?_0x2c86cd[_0x1ed6('0x3a')]['email']===_0x3c59c9[_0x1ed6('0x2e')]&&parseInt(_0x2c86cd[_0x1ed6('0xb')]['id'],null)===parseInt(_0x2c86cd[_0x1ed6('0x3a')]['id'],null)||_0x3c59c9['super_admin']:![];if(_0x4788bd){if(_0x42bf6d){_0x2c86cd[_0x1ed6('0x16')]['email']?delete _0x2c86cd['body'][_0x1ed6('0x2e')]:null;_0x2c86cd[_0x1ed6('0x16')][_0x1ed6('0x4c')]=_0x1ed6('0x4d');_0x2c86cd[_0x1ed6('0x16')][_0x1ed6('0x4e')]=0x0;_0x2c86cd[_0x1ed6('0x16')][_0x1ed6('0x4f')]=![];this[_0x1ed6('0xd')][_0x1ed6('0xe')]['psql'][_0x1ed6('0x50')](_0x2c86cd,_0x4a378b,_0x546f15,_0x1e35e5=>{if(_0x1e35e5){_0x4a378b[_0x1ed6('0xc')](this[_0x1ed6('0xd')][_0x1ed6('0xe')]['send'](0xc8,_0x1ed6('0x51')));this[_0x1ed6('0x22')][_0x1ed6('0xf')]({'from':process['env']['TEST_EMAIL'],'to':process['env'][_0x1ed6('0x1f')],'subject':'Change\x20Password!','html':'<p>You\x20have\x20changed\x20your\x20password!\x20Please\x20Login.</p>'});}});}else{_0x4a378b[_0x1ed6('0xc')](this[_0x1ed6('0xd')][_0x1ed6('0xe')]['sendError'](0x1f4,_0x1ed6('0x52')));}}else{_0x4a378b[_0x1ed6('0xc')](this[_0x1ed6('0xd')][_0x1ed6('0xe')]['sendError'](0x1f4,_0x1ed6('0x53')));}}});}else{_0x4a378b[_0x1ed6('0xc')](this[_0x1ed6('0xd')][_0x1ed6('0xe')][_0x1ed6('0x11')](0x191,_0x1ed6('0x54')));}}else if(_0x3c59c9[_0x1ed6('0x1d')]==0x1f4){_0x4a378b[_0x1ed6('0xc')](this[_0x1ed6('0xd')][_0x1ed6('0xe')][_0x1ed6('0x11')](0x191,_0x1ed6('0x55')));}});});};this['recoverPassword']=(_0x4b98a1,_0x617ca0,_0x11adb6)=>{this[_0x1ed6('0x19')](_0x4b98a1,_0x617ca0,_0x11adb6)[_0x1ed6('0x1a')](_0x2364e5=>{if(!_0x2364e5['errorCode']){const _0x442db0=_0x4b98a1[_0x1ed6('0x16')][_0x1ed6('0x56')];const _0x25b797=_0x4b98a1['body'][_0x1ed6('0x2e')]&&_0x4b98a1[_0x1ed6('0x16')][_0x1ed6('0x2e')]!=null?_0x4b98a1[_0x1ed6('0x16')][_0x1ed6('0x2e')]===_0x2364e5[_0x1ed6('0x2e')]:![];let _0x48808e=![];jwt[_0x1ed6('0x57')](_0x4b98a1['body'][_0x1ed6('0x45')],process[_0x1ed6('0x2b')][_0x1ed6('0x32')],(_0x14a7d3,_0x15b366)=>{if(_0x14a7d3){_0x48808e=!![];}if(_0x25b797&&!_0x48808e){if(_0x442db0){this[_0x1ed6('0x1c')](_0x4b98a1);_0x4b98a1[_0x1ed6('0x16')]={'password':_0x4b98a1[_0x1ed6('0x16')]['newPassword'],'password_reset_at':_0x1ed6('0x4d'),'email_reminder_count':0x0,'locked':![],'where':{'id':_0x2364e5['id']}};this[_0x1ed6('0xd')][_0x1ed6('0xe')][_0x1ed6('0x14')][_0x1ed6('0x3d')](_0x4b98a1,_0x617ca0,_0x11adb6,_0xeb32b1=>{if(_0xeb32b1){this['emailer'][_0x1ed6('0xf')]({'from':process[_0x1ed6('0x2b')][_0x1ed6('0x1f')],'to':process[_0x1ed6('0x2b')][_0x1ed6('0x1f')],'subject':'Recover\x20Password!','html':_0x1ed6('0x58')});_0x617ca0['json'](this[_0x1ed6('0xd')][_0x1ed6('0xe')][_0x1ed6('0xf')](0xc8,_0xeb32b1));}});}else{_0x617ca0[_0x1ed6('0xc')](this[_0x1ed6('0xd')][_0x1ed6('0xe')][_0x1ed6('0x11')](0x1f4,_0x1ed6('0x59')));}}else{_0x617ca0[_0x1ed6('0xc')](this[_0x1ed6('0xd')]['controller'][_0x1ed6('0x11')](0x1f4,_0x1ed6('0x5a')));}});}else if(_0x2364e5['errorCode']==0x1f4){_0x617ca0[_0x1ed6('0xc')](this['model'][_0x1ed6('0xe')][_0x1ed6('0x11')](0x191,'user\x20does\x20not\x20exist!'));}});};this[_0x1ed6('0x5b')]=(_0x5946c8,_0x2a4ab7,_0x2b5385)=>{this[_0x1ed6('0x19')](_0x5946c8,_0x2a4ab7,_0x2b5385)['then'](_0x1bb450=>{if(!_0x1bb450['errorCode']){this[_0x1ed6('0x22')][_0x1ed6('0xf')]({'from':process[_0x1ed6('0x2b')][_0x1ed6('0x1f')],'to':process[_0x1ed6('0x2b')][_0x1ed6('0x1f')],'subject':_0x1ed6('0x5c'),'html':_0x1ed6('0x5d')+process[_0x1ed6('0x2b')]['CLIENT_URL']+_0x1ed6('0x5e')+jwt[_0x1ed6('0x31')]({'email':_0x1bb450[_0x1ed6('0x2e')],'id':_0x1bb450['id']},process[_0x1ed6('0x2b')]['JWT_SECRET'],{'expiresIn':0x3c*0x1e})+_0x1ed6('0x5f')},_0x3df3e1=>{_0x2a4ab7['json'](this[_0x1ed6('0xd')][_0x1ed6('0xe')][_0x1ed6('0xf')](0xc8,[]));});}else if(_0x1bb450['errorCode']==0x1f4){_0x2a4ab7[_0x1ed6('0xc')](this[_0x1ed6('0xd')][_0x1ed6('0xe')][_0x1ed6('0x11')](0x191,_0x1ed6('0x55')));}});};this[_0x1ed6('0x22')]=new mailer_1['Emailer']();}[_0x1ed6('0x1c')](_0x1ed15d){_0x1ed15d[_0x1ed6('0x60')]==null?_0x1ed15d[_0x1ed6('0x60')]=this[_0x1ed6('0xd')][_0x1ed6('0xe')][_0x1ed6('0x61')]():null;return _0x1ed15d;}[_0x1ed6('0x19')](_0x3c3a29,_0x3497a6,_0x3c4a13){return new Promise(_0x232346=>{if(this['options']['dbType']==_0x1ed6('0x9')){this[_0x1ed6('0xd')][_0x1ed6('0x2d')]({'email':_0x3c3a29[_0x1ed6('0x16')][_0x1ed6('0x2e')]},(_0x1bdfc3,_0x41f3cf)=>{if(_0x1bdfc3){_0x232346(_0x1bdfc3);}else if(_0x41f3cf){_0x232346(_0x41f3cf);}else{_0x232346({'errorCode':0x1f4,'errorMessage':_0x1ed6('0x62')});}});}else if(this['options']['dbType']==_0x1ed6('0x12')){const _0x525ada={'get':['*'],'table':this[_0x1ed6('0x13')],'where':{'email':_0x3c3a29[_0x1ed6('0x16')][_0x1ed6('0x2e')]}};this[_0x1ed6('0xd')][_0x1ed6('0xe')]['psql'][_0x1ed6('0x63')](Object[_0x1ed6('0x15')](_0x3c3a29['body'],{'body':_0x525ada}),_0x3497a6,_0x3c4a13,_0x4bb5d9=>{if(_0x4bb5d9['length']==0x0){_0x232346({'errorCode':0x1f4,'errorMessage':_0x1ed6('0x62')});}else{_0x232346(_0x4bb5d9[0x0]);}});}});}['activateAccount'](_0x23522a,_0x59a647,_0x573255,_0x540e26,_0x1161df){_0x59a647['body']={'is_activated':!![],'where':{'id':_0x23522a['id']}};this[_0x1ed6('0xd')][_0x1ed6('0xe')][_0x1ed6('0x14')][_0x1ed6('0x3d')](_0x59a647,_0x573255,_0x540e26,_0x34e1c5=>{if(_0x34e1c5){this[_0x1ed6('0x22')]['send']({'from':process['env'][_0x1ed6('0x1f')],'to':process['env'][_0x1ed6('0x1f')],'subject':'Change\x20Password!','html':_0x1ed6('0x64')});_0x1161df(_0x34e1c5);}});}[_0x1ed6('0x65')](_0x29b4cf,_0x227518,_0x38abdc,_0x54dfca,_0x3b5444){_0x38abdc[_0x1ed6('0x16')]={'locked':!![],'where':{'id':_0x29b4cf['id']}};this['model'][_0x1ed6('0xe')][_0x1ed6('0x14')][_0x1ed6('0x3d')](_0x38abdc,_0x54dfca,_0x3b5444,_0x528102=>{if(_0x528102){_0x38abdc[_0x1ed6('0x28')][_0x1ed6('0x33')][_0x227518][_0x1ed6('0x35')]=0x0;this[_0x1ed6('0x22')][_0x1ed6('0xf')]({'from':process[_0x1ed6('0x2b')][_0x1ed6('0x1f')],'to':process['env'][_0x1ed6('0x1f')],'subject':_0x1ed6('0x66'),'html':_0x1ed6('0x67')+_0x29b4cf['email']+'\x20is\x20locked\x20because\x20of\x20too\x20many\x20failed\x20login\x20attempt!</p>'});_0x54dfca['json'](this[_0x1ed6('0xd')]['controller']['sendError'](0x1a7,'Your\x20account\x20has\x20been\x20locked!\x20Please\x20contact\x20your\x20administrator\x20to\x20unlock\x20your\x20account!'));}});}}exports['Authentication']=Authentication;