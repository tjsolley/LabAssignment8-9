var _0x5f52=['Circular\x20Referenece!\x20Please\x20check\x20table\x20schema:\x20','resolveModels','keys','reduce','fileManager','FileManager','normalize','/../../','readDir','.seed.js','trim','resolve','readFileSync','utf8','getAllSecretFields','count(*)','get','count','SELECT\x20setval(\x27\x22','_id_seq\x22\x27,\x20(SELECT\x20MAX(id)\x20FROM\x20\x22','\x22));','replace','\x20$1\x20$2','$1\x20$2','BaseModel','__awaiter','throw','done','value','apply','next','defineProperty','__esModule','../controllers/base.controller','../routes/base.router','mongoose','path','options','description','customRoutes','repeats','circular','ready','extend','name','schema','init','buildTable','N/A','route','model','router','app','use','desc','nice_name','toLowerCase','A\x20true/false\x20flag\x20use\x20to\x20show/hide\x20','\x20elements\x20on\x20the\x20client\x20application.\x20Useful\x20for\x20soft\x20delete\x20etc.','Active','A\x20string\x20property\x20used\x20to\x20capture\x20the\x20username\x20who\x20create\x20a\x20','\x20record.','Updated\x20By','now','A\x20date\x20property\x20used\x20to\x20capture\x20the\x20timestamp\x20when\x20a\x20','\x20record\x20is\x20created.','Created\x20At','\x20record\x20is\x20updated.','\x20record\x20is\x20permanently\x20deleted.','Deleted\x20At','assign','mongo','Schema','BaseController','api','BaseRouter','controller','isArray','length','forEach','callback','checkTableExist','select\x20count(*)\x20from\x20pg_class\x20where\x20relname=\x27','rows','dbType','postgres','getNiceName','localtimestamp','SYS','getSchema','createTable','data','error','code','42P01','stack','toString','indexOf','lastIndexOf','slice','failedAttempts','statusCode','errorCode','/seed','seed','seedDir','../../seed','checkCircular','push','A\x20table\x20auto\x20generated\x20by\x20normalize.','reverse','filter'];(function(_0x12ccc7,_0x2ce229){var _0xf6699b=function(_0x2ba327){while(--_0x2ba327){_0x12ccc7['push'](_0x12ccc7['shift']());}};_0xf6699b(++_0x2ce229);}(_0x5f52,0xf9));var _0x44c0=function(_0x248393,_0x259367){_0x248393=_0x248393-0x0;var _0x322f07=_0x5f52[_0x248393];return _0x322f07;};'use strict';/*
    Required. The base model for all other models to extend from
*/var __awaiter=this&&this[_0x44c0('0x0')]||function(_0x25feb6,_0x1d2363,_0x2958da,_0x1a275f){return new(_0x2958da||(_0x2958da=Promise))(function(_0x5d9d25,_0x1e863a){function _0xeddec3(_0x42cab4){try{_0x1a7be1(_0x1a275f['next'](_0x42cab4));}catch(_0x3afef5){_0x1e863a(_0x3afef5);}}function _0x94b928(_0x1a9ff8){try{_0x1a7be1(_0x1a275f[_0x44c0('0x1')](_0x1a9ff8));}catch(_0x2dcf60){_0x1e863a(_0x2dcf60);}}function _0x1a7be1(_0x1172dd){_0x1172dd[_0x44c0('0x2')]?_0x5d9d25(_0x1172dd[_0x44c0('0x3')]):new _0x2958da(function(_0x5d9d25){_0x5d9d25(_0x1172dd['value']);})['then'](_0xeddec3,_0x94b928);}_0x1a7be1((_0x1a275f=_0x1a275f[_0x44c0('0x4')](_0x25feb6,_0x1d2363||[]))[_0x44c0('0x5')]());});};Object[_0x44c0('0x6')](exports,_0x44c0('0x7'),{'value':!![]});const base_controller_1=require(_0x44c0('0x8'));const base_router_1=require(_0x44c0('0x9'));const file_manager_1=require('../file-manager/file-manager');const mongoose=require(_0x44c0('0xa'));const path=require(_0x44c0('0xb'));class BaseModel{constructor(_0x2ec345,_0x56a69f,_0x375da4,_0x15dd7c,_0x218ae3,_0x4e0e6b){this[_0x44c0('0xc')]=_0x2ec345;this['name']=_0x56a69f;this['schema']=_0x375da4;this[_0x44c0('0xd')]=_0x15dd7c;this[_0x44c0('0xe')]=_0x218ae3;this['api']=_0x4e0e6b;this[_0x44c0('0xf')]=[];this[_0x44c0('0x10')]=![];this[_0x44c0('0x11')]=![];this[_0x44c0('0x12')](this[_0x44c0('0x13')],this[_0x44c0('0x14')])['make'](this[_0x44c0('0x13')],this[_0x44c0('0x14')],this[_0x44c0('0xe')]);}[_0x44c0('0x15')](){return __awaiter(this,void 0x0,void 0x0,function*(){return new Promise(_0x422b55=>__awaiter(this,void 0x0,void 0x0,function*(){let _0x4d97fc=yield this[_0x44c0('0x16')](this[_0x44c0('0x13')],this[_0x44c0('0x14')],this[_0x44c0('0xd')]!=null?this[_0x44c0('0xd')]:_0x44c0('0x17'));if(_0x4d97fc){this[_0x44c0('0x11')]=!![];}else{this[_0x44c0('0x11')]=![];}_0x422b55(this);}));});}[_0x44c0('0x18')](_0x228ace,_0x20fccd,_0x28e097,_0x4ff59b){let _0x3ee69=this[_0x44c0('0x19')][_0x44c0('0x1a')][_0x44c0('0x12')](_0x228ace,_0x20fccd,_0x28e097,_0x4ff59b);if(_0x3ee69){this['api'][_0x44c0('0x1b')][_0x44c0('0x1c')]('/'+_0x228ace,_0x3ee69);}}['extend'](_0x47acfc,_0x2d2805){for(let _0x388e6c in _0x2d2805){if(_0x2d2805[_0x388e6c]['desc']==null){_0x2d2805[_0x388e6c][_0x44c0('0x1d')]='';}if(_0x2d2805[_0x388e6c][_0x44c0('0x1e')]==null){_0x2d2805[_0x388e6c][_0x44c0('0x1e')]='';}}const _0x39c024=_0x47acfc[_0x44c0('0x1f')]();const _0x4c691a={'active':{'type':Boolean,'default':!![],'desc':_0x44c0('0x20')+_0x39c024+_0x44c0('0x21'),'nice_name':_0x44c0('0x22')},'created_by':{'type':String,'maxlength':0x4b,'desc':_0x44c0('0x23')+_0x39c024+_0x44c0('0x24'),'nice_name':'Created\x20By'},'updated_by':{'type':String,'maxlength':0x4b,'desc':'A\x20string\x20property\x20used\x20to\x20capture\x20the\x20username\x20who\x20update\x20a\x20'+_0x39c024+_0x44c0('0x24'),'nice_name':_0x44c0('0x25')},'created_at':{'type':Date,'default':Date[_0x44c0('0x26')](),'desc':_0x44c0('0x27')+_0x39c024+_0x44c0('0x28'),'nice_name':_0x44c0('0x29'),'timezone':!![]},'updated_at':{'type':Date,'default':Date[_0x44c0('0x26')](),'desc':_0x44c0('0x27')+_0x39c024+_0x44c0('0x2a'),'nice_name':'Updated\x20At','timezone':!![]},'deleted_at':{'type':Date,'default':Date[_0x44c0('0x26')](),'desc':_0x44c0('0x27')+_0x39c024+_0x44c0('0x2b'),'nice_name':_0x44c0('0x2c'),'timezone':!![]}};this[_0x44c0('0x14')]=Object[_0x44c0('0x2d')](_0x2d2805,_0x4c691a);return this;}['make'](_0x53cb96,_0x22c826,_0x14c829){return __awaiter(this,void 0x0,void 0x0,function*(){return new Promise(_0x11c771=>__awaiter(this,void 0x0,void 0x0,function*(){switch(this['options']['dbType']){case _0x44c0('0x2e'):let _0x50b8a2=new mongoose[(_0x44c0('0x2f'))](_0x22c826);this[_0x44c0('0x19')]=mongoose[_0x44c0('0x19')](_0x53cb96,_0x50b8a2);break;case'postgres':this['model']={'model':this,'controller':null,'router':null,'schema':null};this[_0x44c0('0x19')]['controller']=new base_controller_1[(_0x44c0('0x30'))](this['options'],this[_0x44c0('0x13')],this[_0x44c0('0x19')],this[_0x44c0('0x31')]);this[_0x44c0('0x19')][_0x44c0('0x1a')]=new base_router_1[(_0x44c0('0x32'))](this[_0x44c0('0x19')][_0x44c0('0x33')]);this['model'][_0x44c0('0x14')]=_0x22c826;if(_0x14c829&&Array[_0x44c0('0x34')](_0x14c829)&&_0x14c829[_0x44c0('0x35')]>0x0){_0x14c829[_0x44c0('0x36')](_0x1408b9=>{this[_0x44c0('0x18')](_0x1408b9[_0x44c0('0x18')],_0x1408b9['method'],_0x1408b9[_0x44c0('0x37')](this[_0x44c0('0x19')]),_0x1408b9['requireToken']);});}}return this;}));});}[_0x44c0('0x38')](_0x4b8c42,_0x18ae07){return new Promise(_0x3930fb=>{const _0x2a2c31=_0x44c0('0x39')+_0x18ae07+'\x27\x20and\x20relkind=\x27r\x27';_0x4b8c42['query'](_0x2a2c31,(_0x41088b,_0x46ad4a)=>__awaiter(this,void 0x0,void 0x0,function*(){if(_0x41088b){_0x3930fb(![]);}else{let _0x20eb74=_0x46ad4a&&_0x46ad4a['rows']&&_0x46ad4a[_0x44c0('0x3a')]['length']>0x0?_0x46ad4a[_0x44c0('0x3a')][0x0]['count']:0x0;if(_0x20eb74&&_0x20eb74==0x1){_0x3930fb(!![]);}else{_0x3930fb(![]);}}}));});}[_0x44c0('0x16')](_0x456764,_0x5337a6,_0x29694f){return __awaiter(this,void 0x0,void 0x0,function*(){return new Promise(_0x46eb22=>__awaiter(this,void 0x0,void 0x0,function*(){if(this[_0x44c0('0xc')][_0x44c0('0x3b')]=='mongo'){_0x46eb22(!![]);}else if(this['options'][_0x44c0('0x3b')]==_0x44c0('0x3c')){const _0x22b20c={'schema_name':_0x456764,'schema_nice_name':this[_0x44c0('0x3d')](_0x456764),'description':_0x29694f,'schema':_0x5337a6,'created_at':_0x44c0('0x3e'),'updated_at':_0x44c0('0x3e'),'created_by':_0x44c0('0x3f'),'updated_by':'SYS'};const _0x110fe5={'schema':_0x5337a6,'schemaInsertPayload':_0x22b20c};let _0x3b4ea6=this['api'][_0x44c0('0x40')](_0x456764);_0x3b4ea6=_0x3b4ea6!=null?_0x3b4ea6[_0x44c0('0x33')]:this[_0x44c0('0x19')][_0x44c0('0x33')];const _0xd10701=yield _0x3b4ea6[_0x44c0('0x41')](_0x110fe5,null,null);if(_0xd10701&&_0xd10701[_0x44c0('0x42')]&&_0xd10701[_0x44c0('0x42')]['error']&&_0xd10701[_0x44c0('0x42')][_0x44c0('0x43')][_0x44c0('0x13')]=='error'&&_0xd10701['data']['error'][_0x44c0('0x44')]==_0x44c0('0x45')){let _0x4c8d8e=_0x456764;let _0x106272=_0xd10701[_0x44c0('0x42')][_0x44c0('0x43')][_0x44c0('0x46')][_0x44c0('0x47')]();let _0x2b3b1c=_0x106272[_0x44c0('0x48')]('\x22')+0x1;let _0x212e90=_0x106272[_0x44c0('0x49')]('\x22');let _0x106062=_0x106272[_0x44c0('0x4a')](_0x2b3b1c,_0x212e90);BaseModel[_0x44c0('0x4b')][_0x4c8d8e]==null?BaseModel[_0x44c0('0x4b')][_0x4c8d8e]={'table':_0x4c8d8e,'schema':_0x5337a6,'desc':_0x29694f}:![];let _0x2fb67e=yield this['recreate'](_0x4c8d8e,_0x106062,_0x5337a6,_0x29694f);if(!_0x2fb67e){let _0x187ea5=yield this['buildTable'](_0x4c8d8e,_0x5337a6,_0x29694f);_0x46eb22(_0x187ea5);}else{_0x46eb22(!![]);}}else if(_0xd10701&&_0xd10701[_0x44c0('0x42')]&&_0xd10701[_0x44c0('0x42')][_0x44c0('0x4c')]==0xc8&&!(_0xd10701[_0x44c0('0x42')][_0x44c0('0x4d')]==0x1f4)){let _0x3721c4=yield this['seed'](_0x44c0('0x4e'),_0x456764);let _0x2e7193=yield this[_0x44c0('0x4f')](this[_0x44c0('0xc')][_0x44c0('0x50')]!=null?this[_0x44c0('0xc')][_0x44c0('0x50')]:_0x44c0('0x51'),_0x456764);_0x46eb22(!![]);}else{_0x46eb22(!![]);}}}));});}['recreate'](_0x35dece,_0x33ec29,_0x45db9a,_0x492eea){return new Promise(_0x1177ba=>__awaiter(this,void 0x0,void 0x0,function*(){let _0xc91b64=yield this[_0x44c0('0x52')](_0x33ec29);if(_0xc91b64){process['exit']();}else if(BaseModel['failedAttempts'][_0x33ec29]!=null){this[_0x44c0('0xf')][_0x44c0('0x53')](_0x33ec29);let _0x5db519=BaseModel[_0x44c0('0x4b')][_0x33ec29];let _0x533cca=yield this[_0x44c0('0x16')](_0x33ec29,_0x5db519['schema'],_0x5db519[_0x44c0('0x1d')]);if(_0x533cca){let _0x5d9120=yield this[_0x44c0('0x16')](_0x35dece,_0x45db9a,_0x492eea);if(_0x5d9120){delete BaseModel[_0x44c0('0x4b')][_0x33ec29];_0x1177ba(_0x5d9120);}else{_0x1177ba(![]);}}else{let _0x533cca=yield this[_0x44c0('0x16')](_0x35dece,_0x45db9a,_0x492eea);_0x1177ba(_0x533cca);}}else{let _0x4fa738=this[_0x44c0('0x31')][_0x44c0('0x40')](_0x33ec29);let _0x4f6b01=yield this['buildTable'](_0x33ec29,_0x4fa738[_0x44c0('0x14')],_0x44c0('0x54'));if(_0x4f6b01){let _0x57782c=yield this[_0x44c0('0x16')](_0x35dece,_0x45db9a,_0x492eea);_0x1177ba(!![]);}else{_0x1177ba(![]);}}}));}[_0x44c0('0x52')](_0x29c9b6){return new Promise(_0x41b1c7=>{let _0x5d0db0=0x0;this['repeats'][_0x44c0('0x55')]()[_0x44c0('0x36')]((_0x4b62fc,_0x40eef,_0x43fc49)=>{let _0x255125=_0x43fc49[0x0];if(!(_0x40eef==0x0)){if(_0x4b62fc==_0x255125){_0x5d0db0++;}_0x5d0db0>=0x5?this[_0x44c0('0x10')]=!![]:![];}});if(this[_0x44c0('0x10')]){let _0x73c9f1=this[_0x44c0('0xf')]['sort']((_0x59e8ef,_0x330730)=>{return _0x59e8ef>_0x330730?-0x1:0x1;})[_0x44c0('0x56')]((_0x3c349f,_0x46a905,_0x21b0d3)=>{return!_0x46a905||_0x3c349f!=_0x21b0d3[_0x46a905-0x1];});_0x41b1c7(!![]);console['log'](_0x44c0('0x57')+_0x73c9f1);}else{_0x41b1c7(![]);}});}[_0x44c0('0x58')](){return new Promise(_0x18b124=>{Object['keys'](BaseModel[_0x44c0('0x4b')])['length']>0x0?Object[_0x44c0('0x59')](BaseModel[_0x44c0('0x4b')])[_0x44c0('0x5a')]((_0x10f391,_0x4afa4d,_0x5a5338)=>__awaiter(this,void 0x0,void 0x0,function*(){yield _0x10f391;let _0x756f1f=BaseModel['failedAttempts'][_0x4afa4d]||![];if(_0x756f1f){let _0xa39c65=this[_0x44c0('0x31')]['getSchema'](_0x4afa4d)[_0x44c0('0x33')];let _0xa4c0be=yield this[_0x44c0('0x38')](_0xa39c65,_0x4afa4d);if(!_0xa4c0be){let _0x51ef09=yield this[_0x44c0('0x16')](_0x4afa4d,_0x756f1f[_0x44c0('0x14')],_0x756f1f[_0x44c0('0x1d')]);if(_0x51ef09){delete BaseModel[_0x44c0('0x4b')][_0x4afa4d];}}return!![];}return!![];}),Promise['resolve']()):[];_0x18b124(!![]);});}[_0x44c0('0x4f')](_0x506fe5,_0x2cbe1e){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x2a773d=this[_0x44c0('0x31')][_0x44c0('0x40')](_0x2cbe1e)[_0x44c0('0x33')];return new Promise(_0x5583c2=>{this[_0x44c0('0x5b')]=new file_manager_1[(_0x44c0('0x5c'))]();const _0x3461e5=path[_0x44c0('0x5d')](__dirname+_0x44c0('0x5e')+_0x506fe5);this['fileManager'][_0x44c0('0x5f')](_0x3461e5,(_0x5ee6bc,_0x4c96ee)=>__awaiter(this,void 0x0,void 0x0,function*(){if(_0x4c96ee&&_0x4c96ee[_0x44c0('0x35')]>0x0){let _0x4802c5=[];let _0x10f2b8=_0x4c96ee[_0x44c0('0x56')]((_0x420784,_0x123b93,_0x5767fc)=>{if(_0x420784[_0x44c0('0x48')](_0x44c0('0x60'))!==-0x1){const _0x1ec682=_0x420784[_0x44c0('0x4a')](0x0,_0x420784[_0x44c0('0x48')](_0x44c0('0x60')));return _0x1ec682[_0x44c0('0x61')]()['toLowerCase']()==_0x2cbe1e[_0x44c0('0x61')]()[_0x44c0('0x1f')]();}})[_0x44c0('0x5a')]((_0x45c7c1,_0x5a5b2b,_0x1de396,_0x4cce08)=>__awaiter(this,void 0x0,void 0x0,function*(){yield _0x45c7c1;const _0x410866=path[_0x44c0('0x62')](__dirname,_0x3461e5+'/'+_0x5a5b2b);const _0x5588cf=this[_0x44c0('0x5b')][_0x44c0('0x63')](_0x410866,_0x44c0('0x64'),{'toJSON':!![]});const _0x138c55={'secretFields':_0x2a773d[_0x44c0('0x65')](),'body':_0x5588cf};const _0x4bd113={'body':{'get':[_0x44c0('0x66')]}};const _0x21c107=yield _0x2a773d[_0x44c0('0x67')](_0x4bd113,null,null);const _0xbf9f55=_0x21c107&&_0x21c107[_0x44c0('0x42')]!=null?_0x21c107[_0x44c0('0x42')]:[];if(_0xbf9f55!=null&&_0xbf9f55['length']>0x0&&parseInt(_0xbf9f55[0x0][_0x44c0('0x68')])==0x0){let _0x45c7c1=yield _0x2a773d['bulkInsert'](_0x138c55,null,null);_0x4802c5[_0x44c0('0x53')](_0x45c7c1);return _0x4802c5;}else{}}),Promise[_0x44c0('0x62')]());let _0x377aad=yield _0x10f2b8;if(_0x377aad&&_0x377aad['length']>0x0&&_0x377aad[0x0]['data']&&_0x377aad[0x0]['data'][_0x44c0('0x35')]>0x0){let _0x35f3f6=_0x44c0('0x69')+_0x2cbe1e+_0x44c0('0x6a')+_0x2cbe1e+_0x44c0('0x6b');_0x2a773d['query'](_0x35f3f6,(_0x5ee6bc,_0x3a98b4)=>__awaiter(this,void 0x0,void 0x0,function*(){if(_0x5ee6bc){}else{}}));}_0x5583c2(!![]);}else{_0x5583c2(!![]);}}));});});}[_0x44c0('0x3d')](_0xe8a9b7){return _0xe8a9b7[_0x44c0('0x6c')](/([A-Z]+)([A-Z][a-z])/g,_0x44c0('0x6d'))[_0x44c0('0x6c')](/([a-z\d])([A-Z])/g,_0x44c0('0x6e'))[_0x44c0('0x6c')](/([a-zA-Z])(\d)/g,_0x44c0('0x6e'))[_0x44c0('0x6c')](/^./,function(_0xe8a9b7){return _0xe8a9b7['toUpperCase']();})['trim']();}}BaseModel[_0x44c0('0x4b')]={};exports[_0x44c0('0x6f')]=BaseModel;